% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={thesis},
  pdfauthor={BHARATH SHIVADAS KOTIAN},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{thesis}
\author{BHARATH SHIVADAS KOTIAN}
\date{2025-03-25}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load libraries}
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'tidyverse' was built under R version 4.4.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'ggplot2' was built under R version 4.4.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'tidyr' was built under R version 4.4.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'readr' was built under R version 4.4.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'dplyr' was built under R version 4.4.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'forcats' was built under R version 4.4.2
\end{verbatim}

\begin{verbatim}
## Warning: package 'lubridate' was built under R version 4.4.2
\end{verbatim}

\begin{verbatim}
## -- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
## v dplyr     1.1.4     v readr     2.1.5
## v forcats   1.0.0     v stringr   1.5.1
## v ggplot2   3.5.1     v tibble    3.2.1
## v lubridate 1.9.3     v tidyr     1.3.1
## v purrr     1.0.2     
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
## i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(readr)}
\FunctionTok{library}\NormalTok{(corrplot)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'corrplot' was built under R version 4.4.3
\end{verbatim}

\begin{verbatim}
## corrplot 0.95 loaded
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(psych)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'psych' was built under R version 4.4.3
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'psych'
## 
## The following objects are masked from 'package:ggplot2':
## 
##     %+%, alpha
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(cluster)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the data}
\NormalTok{ess }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"ESS Theme {-} Personal and social wellbeing.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 97673 Columns: 69
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (3): name, proddate, cntry
## dbl (66): essround, edition, idno, dweight, pspwght, pweight, anweight, absd...
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# View structure}
\FunctionTok{glimpse}\NormalTok{(ess)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 97,673
## Columns: 69
## $ name     <chr> "ESS3e03_7", "ESS3e03_7", "ESS3e03_7", "ESS3e03_7", "ESS3e03_~
## $ essround <dbl> 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3~
## $ edition  <dbl> 3.7, 3.7, 3.7, 3.7, 3.7, 3.7, 3.7, 3.7, 3.7, 3.7, 3.7, 3.7, 3~
## $ proddate <chr> "01.12.2018", "01.12.2018", "01.12.2018", "01.12.2018", "01.1~
## $ idno     <dbl> 3, 6, 8, 9, 11, 12, 14, 15, 17, 18, 20, 21, 23, 24, 27, 32, 3~
## $ cntry    <chr> "AT", "AT", "AT", "AT", "AT", "AT", "AT", "AT", "AT", "AT", "~
## $ dweight  <dbl> 1.2429, 0.8286, 0.8286, 1.2429, 0.8286, 1.6572, 0.4143, 1.657~
## $ pspwght  <dbl> 0.9495779, 1.4121802, 0.7232761, 0.6257438, 0.4171625, 3.7887~
## $ pweight  <dbl> 0.2891161, 0.2891161, 0.2891161, 0.2891161, 0.2891161, 0.2891~
## $ anweight <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ absddng  <dbl> 2, 3, 3, 2, 3, 2, 3, 2, 4, 3, 8, 3, 4, 2, 3, 3, 1, 1, 4, 1, 4~
## $ accdng   <dbl> 2, 1, 2, 1, 2, 1, 3, 1, 1, 2, 8, 2, 2, 1, 1, 1, 3, 5, 1, 3, 1~
## $ atnoact  <dbl> 5, 2, 3, 3, 5, 6, 3, 6, 5, 6, 2, 6, 6, 6, 5, 6, 6, 6, 2, 6, 2~
## $ chlrnnw  <dbl> 4, 6, 4, 3, 3, 1, 4, 6, 5, 3, 5, 3, 6, 3, 4, 3, 3, 1, 6, 3, 6~
## $ dclvlf   <dbl> 1, 1, 3, 2, 2, 1, 3, 2, 1, 1, 2, 2, 4, 2, 2, 1, 5, 5, 1, 5, 1~
## $ deaimpp  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ dngval   <dbl> 2, 2, 2, 2, 2, 2, 3, 2, 1, 1, 2, 2, 4, 1, 2, 3, 5, 3, 1, 3, 2~
## $ enjstm   <dbl> 2, 4, 3, 3, 3, 2, 3, 2, 1, 4, 4, 4, 4, 3, 1, 3, 3, 5, 2, 2, 4~
## $ enrglot  <dbl> 3, 3, 3, 3, 3, 2, 3, 1, 1, 2, 8, 4, 4, 3, 3, 3, 8, 1, 3, 2, 4~
## $ flapppl  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ flclpla  <dbl> 3, 3, 2, 3, 3, 1, 3, 2, 2, 1, 4, 2, 2, 1, 3, 3, 2, 3, 1, 3, 3~
## $ flrms    <dbl> 3, 3, 4, 5, 5, 2, 3, 2, 5, 5, 2, 4, 8, 2, 5, 3, 2, 8, 5, 8, 5~
## $ fltanx   <dbl> 1, 2, 1, 1, 2, 2, 3, 4, 8, 1, 8, 1, 2, 1, 1, 1, 4, 3, 1, 4, 1~
## $ fltbrd   <dbl> 1, 1, 1, 1, 1, 2, 3, 1, 1, 1, 8, 2, 1, 1, 1, 1, 2, 3, 1, 8, 1~
## $ fltpcfl  <dbl> 3, 2, 2, 2, 2, 3, 3, 2, 2, 3, 8, 4, 4, 4, 1, 3, 1, 1, 2, 1, 4~
## $ fltrstm  <dbl> 3, 1, 2, 4, 3, 3, 3, 2, 1, 4, 8, 3, 4, 4, 2, 4, 3, 1, 3, 1, 4~
## $ flttrd   <dbl> 2, 2, 1, 1, 2, 2, 3, 4, 4, 2, 8, 2, 1, 3, 2, 1, 1, 3, 1, 4, 1~
## $ fmlenj   <dbl> 4, 6, 4, 5, 5, 4, 6, 6, 6, 6, 88, 5, 6, 5, 6, 2, 3, 0, 2, 4, ~
## $ fmlstrs  <dbl> 2, 0, 2, 2, 3, 4, 0, 2, 5, 0, 88, 2, 2, 3, 1, 4, 3, 6, 4, 1, ~
## $ fstwttv  <dbl> 3, 3, 4, 4, 3, 4, 4, 4, 4, 4, 4, 4, 2, 4, 4, 4, 4, 4, 4, 2, 4~
## $ hlpoth   <dbl> 5, 2, 4, 2, 5, 5, 4, 6, 1, 1, 2, 2, 1, 2, 5, 6, 6, 6, 2, 6, 2~
## $ hlprtrn  <dbl> 4, 4, 2, 2, 3, 1, 3, 3, 4, 3, 4, 4, 4, 2, 1, 4, 3, 3, 2, 2, 5~
## $ inccmp   <dbl> 6, 5, 4, 0, 3, 66, 5, 4, 0, 66, 66, 66, 0, 88, 6, 66, 66, 66,~
## $ inccmpw  <dbl> 3, 1, 1, 5, 1, 6, 4, 4, 5, 6, 6, 6, 8, 8, 3, 6, 6, 6, 1, 6, 5~
## $ jbintr   <dbl> 5, 3, 4, 6, 4, 66, 4, 2, 6, 66, 66, 66, 6, 5, 6, 66, 66, 66, ~
## $ jbstrs   <dbl> 3, 3, 4, 2, 3, 66, 4, 4, 6, 66, 66, 66, 6, 4, 4, 66, 66, 66, ~
## $ lchshcp  <dbl> 3, 3, 4, 4, 3, 2, 3, 4, 1, 4, 4, 4, 4, 4, 3, 5, 1, 2, 4, 3, 5~
## $ lfcllk   <dbl> 2, 3, 2, 2, 2, 2, 3, 3, 8, 2, 8, 2, 3, 1, 2, 2, 4, 8, 2, 8, 2~
## $ lfwrs    <dbl> 4, 2, 4, 2, 2, 1, 3, 1, 2, 3, 4, 3, 2, 2, 3, 3, 2, 8, 5, 3, 3~
## $ lotsgot  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ lrnnew   <dbl> 2, 1, 2, 2, 2, 1, 3, 1, 8, 2, 2, 2, 2, 2, 1, 1, 2, 3, 1, 3, 1~
## $ lrnntlf  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ nhpftr   <dbl> 4, 2, 4, 5, 4, 2, 3, 2, 8, 4, 4, 4, 2, 8, 3, 4, 1, 5, 5, 1, 5~
## $ optftr   <dbl> 2, 3, 2, 2, 2, 5, 3, 3, 4, 2, 2, 2, 4, 2, 2, 2, 5, 8, 1, 5, 2~
## $ pactlot  <dbl> 3, 3, 3, 2, 2, 2, 3, 2, 4, 2, 2, 2, 4, 2, 3, 3, 5, 5, 3, 5, 2~
## $ pdwrkcr  <dbl> 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 8, 2, 1, 1, 1, 2, 2, 2, 1, 2, 1~
## $ physact  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ plinsoc  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ plprftr  <dbl> 2, 1, 3, 1, 2, 3, 3, 3, 4, 3, 8, 3, 4, 1, 3, 1, 3, 5, 1, 3, 1~
## $ pplahlp  <dbl> 4, 4, 4, 1, 3, 3, 4, 3, 8, 5, 2, 3, 5, 5, 4, 5, 3, 5, 6, 3, 3~
## $ ppllfcr  <dbl> 1, 1, 2, 1, 1, 1, 3, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 5, 1, 3, 1~
## $ prhlppl  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ pstvms   <dbl> 2, 3, 2, 2, 2, 2, 3, 4, 1, 1, 2, 2, 4, 2, 2, 3, 3, 8, 1, 8, 2~
## $ rcndsrv  <dbl> 5, 2, 4, 5, 4, 4, 4, 5, 6, 5, 3, 4, 5, 6, 1, 3, 3, 3, 6, 3, 5~
## $ rehlppl  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ sedirlf  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ stfjb    <dbl> 8, 7, 3, 9, 7, 66, 4, 10, 8, 66, 66, 66, 9, 10, 1, 66, 66, 66~
## $ stflfsf  <dbl> 7, 7, 3, 9, 8, 5, 9, 5, 88, 7, 8, 7, 7, 7, 7, 8, 7, 2, 10, 4,~
## $ stfsdlv  <dbl> 7, 4, 2, 10, 8, 7, 6, 3, 88, 7, 8, 7, 7, 7, 5, 6, 3, 1, 10, 2~
## $ tmabdng  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ tmdotwa  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ tmendng  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ tmimdng  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ tnapsur  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N~
## $ trtrsp   <dbl> 6, 3, 4, 6, 4, 5, 4, 6, 5, 6, 3, 4, 5, 5, 5, 5, 3, 3, 6, 3, 4~
## $ trtunf   <dbl> 2, 4, 1, 0, 1, 5, 4, 1, 1, 0, 3, 2, 0, 2, 0, 1, 3, 3, 0, 3, 1~
## $ uempnyr  <dbl> 4, 4, 4, 3, 4, 6, 3, 8, 4, 6, 6, 6, 4, 4, 2, 6, 6, 6, 4, 6, 8~
## $ wkvlorg  <dbl> 6, 1, 4, 5, 5, 6, 6, 6, 6, 6, 1, 6, 6, 6, 5, 5, 6, 6, 1, 6, 3~
## $ wrbknrm  <dbl> 4, 3, 4, 2, 4, 1, 3, 2, 8, 4, 4, 4, 8, 8, 3, 3, 3, 3, 2, 3, 4~
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Drop columns with more than 50\% missing values}
\NormalTok{ess\_clean }\OtherTok{\textless{}{-}}\NormalTok{ ess }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\FunctionTok{where}\NormalTok{(}\SpecialCharTok{\textasciitilde{}} \FunctionTok{mean}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(.)) }\SpecialCharTok{\textgreater{}} \FloatTok{0.5}\NormalTok{))}

\CommentTok{\# Check missingness}
\FunctionTok{sapply}\NormalTok{(ess\_clean, }\ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(x)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     name essround  edition proddate     idno    cntry  dweight  pspwght 
##        0        0        0        0        0        0        0        0 
##  pweight anweight   accdng   dclvlf  deaimpp   dngval  enrglot  flapppl 
##        0    43000        0        0    43000        0     1518    43000 
##  flclpla    flrms   fltanx  fltpcfl  lchshcp    lfwrs  lotsgot  lrnntlf 
##        0        0        0        0        0        0    43000    43000 
##   nhpftr   optftr  physact  plinsoc  pplahlp  prhlppl   pstvms  rehlppl 
##        0        0    43000    43000        0    43000        0    43000 
##  sedirlf    stfjb  tmabdng  tmdotwa  tmendng  tmimdng  tnapsur   trtrsp 
##    43000        0    43000    43000    43000    43000    43000        0 
##  wkvlorg  wrbknrm 
##        0        0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Step 1: Calculate country{-}level means (already done)}
\NormalTok{country\_factors }\OtherTok{\textless{}{-}}\NormalTok{ ess\_clean }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(cntry) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{Mean\_Life\_Valuable =} \FunctionTok{mean}\NormalTok{(dngval, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{Mean\_Positivity =} \FunctionTok{mean}\NormalTok{(pstvms, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{Mean\_Optimism =} \FunctionTok{mean}\NormalTok{(optftr, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{Mean\_Job\_Satisfaction =} \FunctionTok{mean}\NormalTok{(stfjb, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{Mean\_Resilience =} \FunctionTok{mean}\NormalTok{(wrbknrm, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{Mean\_Calmness =} \FunctionTok{mean}\NormalTok{(fltpcfl, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{Mean\_Anxiety =} \FunctionTok{mean}\NormalTok{(fltanx, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}

\CommentTok{\# Step 2: Rank the countries based on \textquotesingle{}Mean\_Life\_Valuable\textquotesingle{}}
\NormalTok{country\_ranking }\OtherTok{\textless{}{-}}\NormalTok{ country\_factors }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(Mean\_Life\_Valuable)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Rank =} \FunctionTok{row\_number}\NormalTok{())}

\CommentTok{\# Step 3: View the ranking}
\FunctionTok{print}\NormalTok{(country\_ranking)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 30 x 9
##    cntry Mean_Life_Valuable Mean_Positivity Mean_Optimism Mean_Job_Satisfaction
##    <chr>              <dbl>           <dbl>         <dbl>                 <dbl>
##  1 RU                  2.63            2.20          2.48                  34.3
##  2 UA                  2.53            2.28          2.41                  40.9
##  3 BG                  2.42            2.30          2.63                  41.2
##  4 CZ                  2.37            2.55          2.61                  36.8
##  5 HU                  2.36            2.52          2.66                  39.6
##  6 LT                  2.33            2.51          2.51                  38.5
##  7 EE                  2.23            2.21          2.35                  34.0
##  8 SK                  2.20            2.33          2.47                  35.5
##  9 DE                  2.15            1.98          2.17                  34.9
## 10 PL                  2.14            2.15          2.43                  37.8
## # i 20 more rows
## # i 4 more variables: Mean_Resilience <dbl>, Mean_Calmness <dbl>,
## #   Mean_Anxiety <dbl>, Rank <int>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(readr)}

\CommentTok{\# Load the dataset}
\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"ESS6e02\_6.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 54673 Columns: 625
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (10): name, proddate, cntry, ctzshipc, cntbrthc, lnghom1, lnghom2, fbrn...
## dbl (615): essround, edition, idno, dweight, pspwght, pweight, anweight, tvt...
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Clean and transform}
\NormalTok{data }\OtherTok{\textless{}{-}}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{gndr =} \FunctionTok{factor}\NormalTok{(gndr, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Male"}\NormalTok{, }\StringTok{"Female"}\NormalTok{)),}
    \AttributeTok{health\_group =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{      health }\SpecialCharTok{\textless{}=} \DecValTok{2} \SpecialCharTok{\textasciitilde{}} \StringTok{"Good"}\NormalTok{,}
\NormalTok{      health }\SpecialCharTok{==} \DecValTok{3} \SpecialCharTok{\textasciitilde{}} \StringTok{"Fair"}\NormalTok{,}
\NormalTok{      health }\SpecialCharTok{\textgreater{}=} \DecValTok{4} \SpecialCharTok{\textasciitilde{}} \StringTok{"Bad"}\NormalTok{,}
      \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \ConstantTok{NA\_character\_}
\NormalTok{    ),}
    \AttributeTok{age\_group =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{      agea }\SpecialCharTok{\textgreater{}=} \DecValTok{15} \SpecialCharTok{\&}\NormalTok{ agea }\SpecialCharTok{\textless{}=} \DecValTok{29} \SpecialCharTok{\textasciitilde{}} \StringTok{"15–29"}\NormalTok{,}
\NormalTok{      agea }\SpecialCharTok{\textgreater{}=} \DecValTok{30} \SpecialCharTok{\&}\NormalTok{ agea }\SpecialCharTok{\textless{}=} \DecValTok{44} \SpecialCharTok{\textasciitilde{}} \StringTok{"30–44"}\NormalTok{,}
\NormalTok{      agea }\SpecialCharTok{\textgreater{}=} \DecValTok{45} \SpecialCharTok{\&}\NormalTok{ agea }\SpecialCharTok{\textless{}=} \DecValTok{59} \SpecialCharTok{\textasciitilde{}} \StringTok{"45–59"}\NormalTok{,}
\NormalTok{      agea }\SpecialCharTok{\textgreater{}=} \DecValTok{60} \SpecialCharTok{\textasciitilde{}} \StringTok{"60+"}\NormalTok{,}
      \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \ConstantTok{NA\_character\_}
\NormalTok{    )}
\NormalTok{  ) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(gndr))  }\CommentTok{\# ✅ Remove rows where gender is NA}
\end{Highlighting}
\end{Shaded}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Happiness by Health
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cntry, }\AttributeTok{y =}\NormalTok{ happy, }\AttributeTok{fill =}\NormalTok{ health\_group)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{"bar"}\NormalTok{, }\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(), }\AttributeTok{width =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Level of happiness by health"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Average Happiness"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"Health"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{90}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{data-analytics-project_files/figure-latex/unnamed-chunk-5-1.pdf}
3.Life Satisfaction by Gender

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cntry, }\AttributeTok{y =}\NormalTok{ stflife, }\AttributeTok{fill =}\NormalTok{ gndr)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{"bar"}\NormalTok{, }\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(), }\AttributeTok{width =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Level of life satisfaction by gender"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Average Life Satisfaction"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"Gender"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{90}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{data-analytics-project_files/figure-latex/unnamed-chunk-6-1.pdf}

4.Happiness by Gender

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cntry, }\AttributeTok{y =}\NormalTok{ happy, }\AttributeTok{fill =}\NormalTok{ gndr)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{"bar"}\NormalTok{, }\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(), }\AttributeTok{width =} \FloatTok{0.7}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Level of happiness by gender"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Average Happiness"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"Gender"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{90}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{data-analytics-project_files/figure-latex/unnamed-chunk-7-1.pdf}
5.Life Satisfaction by Age Group

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(data, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cntry, }\AttributeTok{y =}\NormalTok{ stflife, }\AttributeTok{fill =}\NormalTok{ age\_group)) }\SpecialCharTok{+}
  \FunctionTok{stat\_summary}\NormalTok{(}\AttributeTok{fun =}\NormalTok{ mean, }\AttributeTok{geom =} \StringTok{"bar"}\NormalTok{, }\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{(), }\AttributeTok{width =} \FloatTok{0.8}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Level of life satisfaction by age"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Average Life Satisfaction"}\NormalTok{, }\AttributeTok{fill =} \StringTok{"Age Group"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{axis.text.x =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{angle =} \DecValTok{90}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{data-analytics-project_files/figure-latex/unnamed-chunk-8-1.pdf}

\end{document}
